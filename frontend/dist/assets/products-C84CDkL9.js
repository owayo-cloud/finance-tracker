import{a5 as fe,r as b,ad as oe,b as le,ag as K,h as W,c as ce,j as e,T as g,ah as O,u as Se,af as ve,at as Ce,au as Pe,av as ke,aw as _e,ax as we,ay as ze,az as Te,l as m,H as w,e as v,f as E,ak as ae,al as De,am as Fe,an as ue,q as H,be as Ee,bf as ge,bg as xe,bh as me,bi as F,aA as Ie,bj as Re,C as Be,a as Oe,bk as Le,ae as ie,ap as ne,aq as he,ba as qe,bl as B,bm as L}from"./index-U_CCWg91.js";import{B as Ae,S as q,P as We,a as Ne,b as Me,c as Ke}from"./pagination-COuKxq-9.js";import{D as He,a as Ue,b as Qe,c as Ge,d as $e,e as Ve,f as Ye,g as Je,h as Xe}from"./dialog-Dk2vRJpD.js";import{V as A}from"./v-stack-CGRLQPZF.js";import{B as f}from"./badge-DPauIkpv.js";import{S as Ze}from"./separator-CWDodbLO.js";import{T as pe,a as je,b as J,c as p,d as be,e as j}from"./table-ZlS8bbiA.js";import{H as es}from"./index-B8T0vdp5.js";const{withProvider:ss,withContext:X}=fe({key:"emptyState"}),rs=ss("div","root"),ts=X("div","content"),is=X("div","indicator"),ns=X("h3","title"),as=X("p","description"),os=({product:r,children:i,isOpen:d,onOpenChange:l,"data-testid":n})=>{const[c,S]=b.useState(!1),k=oe(),{showSuccessToast:o}=ce(),C=d!==void 0?d:c,u=l||S,P=le({mutationFn:x=>K.deleteProduct({id:x}),onSuccess:()=>{o("Product deleted successfully."),u(!1)},onError:x=>{W(x)},onSettled:()=>{k.invalidateQueries({queryKey:["products"]})}}),t=async()=>{P.mutate(r.id)};return e.jsxs(He,{size:{base:"xs",md:"md"},placement:"center",open:C,onOpenChange:({open:x})=>u(x),"data-testid":n,children:[i&&d===void 0&&e.jsx(Ue,{asChild:!0,children:i}),e.jsxs(Qe,{children:[e.jsx(Ge,{children:e.jsx($e,{children:"Delete Product"})}),e.jsxs(Ve,{children:[e.jsxs(g,{children:["Are you sure you want to delete ",e.jsx("strong",{children:r.name}),"? This action cannot be undone."]}),r.current_stock!=null&&r.current_stock>0&&e.jsxs(g,{color:"orange.500",mt:2,children:["Warning: This product has ",r.current_stock," units in stock."]})]}),e.jsxs(Ye,{gap:2,children:[e.jsx(Je,{asChild:!0,children:e.jsx(O,{variant:"subtle",colorPalette:"gray",disabled:P.isPending,children:"Cancel"})}),e.jsx(O,{colorPalette:"red",onClick:t,loading:P.isPending,children:"Delete"})]}),e.jsx(Xe,{})]})]})},ls=({product:r,children:i,isOpen:d,onOpenChange:l,"data-testid":n})=>{const[c,S]=b.useState(!1),[k,o]=b.useState(null),[C,u]=b.useState(null),[P,t]=b.useState(!1),x=b.useRef(null),I=oe(),{showSuccessToast:Z}=ce(),z=d!==void 0?d:c,N=l||S,{register:R,handleSubmit:ee,reset:G,formState:{errors:y,isValid:T,isSubmitting:U,isDirty:se}}=Se({mode:"onBlur",criteriaMode:"all",defaultValues:r}),$=le({mutationFn:async h=>{let s=h.image_id;if(k){t(!0);try{s=(await ve.uploadImage({formData:{file:k}})).id}catch(a){throw t(!1),a}t(!1)}return K.updateProduct({id:r.id,requestBody:{...h,image_id:s}})},onSuccess:()=>{Z("Product updated successfully! ✅"),o(null),u(null),N(!1)},onError:h=>{W(h)},onSettled:()=>{I.invalidateQueries({queryKey:["products"]})}}),V=h=>{const s=h.target.files?.[0];if(s){const a=["image/jpeg","image/jpg","image/png"],re=[".jpg",".jpeg",".png"],de=s.name.toLowerCase(),ye=de.substring(de.lastIndexOf("."));if(!a.includes(s.type)||!re.includes(ye)){W({}),x.current&&(x.current.value="");return}if(s.size>5*1024*1024){W({}),x.current&&(x.current.value="");return}o(s);const te=new FileReader;te.onloadend=()=>{u(te.result)},te.readAsDataURL(s)}},Y=()=>{o(null),u(null),x.current&&(x.current.value="")},M=h=>{$.mutate(h)},D=()=>{G(),o(null),u(null),N(!1)},_=()=>{G(r),o(null),u(null),N(!0)};return e.jsxs(e.Fragment,{children:[i&&d===void 0&&e.jsx("div",{onClick:_,style:{cursor:"pointer",display:"inline-block"},children:i}),e.jsxs(Ce,{open:z,onOpenChange:h=>!h.open&&D(),size:"md",placement:"end","data-testid":n,children:[e.jsx(Pe,{}),e.jsxs(ke,{children:[e.jsxs(_e,{borderBottomWidth:"1px",children:[e.jsxs(we,{children:["Edit Product - ",r.name]}),e.jsx(ze,{})]}),e.jsx(Te,{children:e.jsxs(A,{gap:6,align:"stretch",children:[e.jsxs(m,{children:[e.jsx(g,{fontSize:"md",fontWeight:"semibold",mb:3,children:"Current Product Information"}),e.jsxs(A,{align:"stretch",gap:2,p:4,borderWidth:"1px",borderRadius:"md",bg:"gray.900",children:[e.jsxs(w,{justify:"space-between",children:[e.jsx(g,{fontSize:"sm",color:"gray.400",children:"Product ID"}),e.jsx(g,{fontSize:"xs",color:"gray.500",fontFamily:"mono",children:r.id})]}),e.jsxs(w,{justify:"space-between",children:[e.jsx(g,{fontSize:"sm",color:"gray.400",children:"Category"}),e.jsx(f,{colorScheme:"blue",size:"sm",children:r.category?.name||"No category"})]}),e.jsxs(w,{justify:"space-between",children:[e.jsx(g,{fontSize:"sm",color:"gray.400",children:"Status"}),e.jsx(f,{colorScheme:"purple",size:"sm",children:r.status?.name||"No status"})]}),e.jsxs(w,{justify:"space-between",children:[e.jsx(g,{fontSize:"sm",color:"gray.400",children:"Current Stock"}),e.jsxs(f,{colorScheme:r.current_stock===0?"red":r.current_stock&&r.reorder_level&&r.current_stock<=r.reorder_level?"orange":"green",size:"sm",children:[r.current_stock||0," units"]})]})]})]}),e.jsx(Ze,{}),e.jsxs(m,{children:[e.jsx(g,{fontSize:"md",fontWeight:"semibold",mb:3,children:"Update Product Details"}),e.jsx("form",{onSubmit:ee(M),id:"edit-product-form","data-testid":"edit-product-form",children:e.jsxs(A,{gap:4,align:"stretch",children:[e.jsx(v,{invalid:!!y.name,errorText:y.name?.message,label:"Product Name",children:e.jsx(E,{...R("name",{required:"Product name is required"}),placeholder:"Enter product name",type:"text"})}),e.jsx(v,{invalid:!!y.description,errorText:y.description?.message,label:"Description",children:e.jsx(E,{...R("description"),placeholder:"Product description (optional)",type:"text"})}),e.jsx(v,{invalid:!!y.buying_price,errorText:y.buying_price?.message,label:"Buying Price (KES)",helperText:"Cost price for procurement",children:e.jsx(E,{...R("buying_price",{valueAsNumber:!0,required:"Buying price is required",min:{value:.01,message:"Buying price must be greater than 0"}}),placeholder:"0.00",type:"number",step:"0.01"})}),e.jsx(v,{invalid:!!y.selling_price,errorText:y.selling_price?.message,label:"Selling Price (KES)",helperText:"Must be greater than buying price",children:e.jsx(E,{...R("selling_price",{valueAsNumber:!0,required:"Selling price is required",validate:(h,s)=>{const a=typeof h=="number"?h:parseFloat(String(h));if(!a||a<=0)return"Selling price must be greater than 0";const re=typeof s.buying_price=="number"?s.buying_price:parseFloat(String(s.buying_price||0));return a<=re?"Selling price must be greater than buying price":!0}}),placeholder:"0.00",type:"number",step:"0.01"})}),e.jsx(v,{invalid:!!y.current_stock,errorText:y.current_stock?.message,label:"Current Stock",helperText:"Available units in inventory (minimum 1)",children:e.jsx(E,{...R("current_stock",{valueAsNumber:!0,min:{value:1,message:"Stock must be at least 1"}}),placeholder:"1",type:"number"})}),e.jsx(v,{invalid:!!y.reorder_level,errorText:y.reorder_level?.message,label:"Reorder Level",helperText:"Minimum stock before reordering",children:e.jsx(E,{...R("reorder_level",{valueAsNumber:!0,min:{value:0,message:"Reorder level cannot be negative"}}),placeholder:"0",type:"number"})}),e.jsxs(v,{label:"Product Image",helperText:"Upload a JPG or PNG image (max 5MB)",children:[e.jsx("input",{ref:x,type:"file",accept:".jpg,.jpeg,.png,image/jpeg,image/png",onChange:V,style:{display:"none"}}),C?e.jsxs(m,{position:"relative",children:[e.jsx(ae,{src:C,alt:"New product preview",borderRadius:"md",maxH:"250px",objectFit:"contain",w:"full",bg:{base:"gray.800",_light:"gray.50"},border:"1px solid",borderColor:{base:"gray.700",_light:"gray.200"}}),e.jsx(De,{position:"absolute",top:2,right:2,size:"sm",colorScheme:"red",onClick:Y,"aria-label":"Remove new image",children:e.jsx(Fe,{})}),e.jsx(f,{position:"absolute",bottom:2,left:2,colorScheme:"green",size:"sm",children:"New Image Selected"})]}):r.image?.id?e.jsxs(m,{children:[e.jsx(g,{fontSize:"sm",mb:2,color:{base:"gray.400",_light:"gray.600"},fontWeight:"medium",children:"Current Image:"}),e.jsxs(m,{position:"relative",children:[e.jsx(ae,{src:`/api/v1/media/serve/${r.image.id}`,alt:r.name,borderRadius:"md",maxH:"250px",objectFit:"contain",w:"full",bg:{base:"gray.800",_light:"gray.50"},border:"1px solid",borderColor:{base:"gray.700",_light:"gray.200"},mb:3}),e.jsx(f,{position:"absolute",bottom:14,left:2,colorScheme:"blue",size:"sm",children:"Current"})]}),e.jsxs(O,{size:"sm",variant:"outline",colorScheme:"teal",onClick:()=>x.current?.click(),w:"full",children:[e.jsx(ue,{})," Replace Image"]})]}):e.jsx(m,{border:"2px dashed",borderColor:{base:"gray.600",_light:"gray.300"},borderRadius:"md",p:6,textAlign:"center",cursor:"pointer",_hover:{borderColor:"teal.400"},onClick:()=>x.current?.click(),children:e.jsxs(H,{direction:"column",align:"center",gap:2,children:[e.jsx(ue,{size:24}),e.jsx(g,{fontSize:"sm",children:"Click to upload image"}),e.jsx(g,{fontSize:"xs",color:{base:"gray.400",_light:"gray.500"},children:"PNG, JPG up to 5MB"})]})})]})]})})]})]})}),e.jsxs(Ee,{borderTopWidth:"1px",gap:3,children:[e.jsx(O,{variant:"outline",colorScheme:"gray",disabled:U||P,onClick:D,flex:"1",children:"Cancel"}),e.jsx(O,{colorScheme:"teal",type:"submit",form:"edit-product-form",disabled:!se||!T||P,loading:U||P,flex:"1",children:P?"Uploading...":"Update Product"})]})]})]})]})},cs=({product:r})=>{const[i,d]=b.useState(!1),[l,n]=b.useState(!1),[c,S]=b.useState(!1),k=()=>{S(!1),setTimeout(()=>d(!0),100)},o=()=>{S(!1),setTimeout(()=>n(!0),100)};return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{open:c,onOpenChange:C=>S(C.open),"data-testid":"product-actions-menu",children:[e.jsx(xe,{asChild:!0,children:e.jsx(Ae,{fontSize:18,cursor:"pointer","data-testid":"product-actions-trigger"})}),e.jsxs(me,{children:[e.jsxs(F,{value:"edit",onClick:k,"data-testid":"edit-product-menu-item",children:[e.jsx(Ie,{fontSize:16}),"Edit Product"]}),e.jsxs(F,{value:"delete",color:"red.500",onClick:o,"data-testid":"delete-product-menu-item",children:[e.jsx(Re,{fontSize:16}),"Delete Product"]})]})]}),e.jsx(ls,{product:r,isOpen:i,onOpenChange:d,"data-testid":"edit-product-drawer"}),e.jsx(os,{product:r,isOpen:l,onOpenChange:n,"data-testid":"delete-product-dialog"})]})},ds=()=>e.jsxs(pe,{size:{base:"sm",md:"md"},children:[e.jsx(je,{children:e.jsxs(J,{children:[e.jsx(p,{children:"Product"}),e.jsx(p,{children:"Category"}),e.jsx(p,{children:"Tag"}),e.jsx(p,{children:"Buying Price"}),e.jsx(p,{children:"Selling Price"}),e.jsx(p,{children:"Current Stock"}),e.jsx(p,{children:"Reorder Level"}),e.jsx(p,{children:"Status"}),e.jsx(p,{children:"Actions"})]})}),e.jsx(be,{children:[...Array(5)].map((r,i)=>e.jsxs(J,{children:[e.jsx(j,{children:e.jsx(q,{noOfLines:1})}),e.jsx(j,{children:e.jsx(q,{noOfLines:1})}),e.jsx(j,{children:e.jsx(q,{noOfLines:1})}),e.jsx(j,{children:e.jsx(q,{noOfLines:1})}),e.jsx(j,{children:e.jsx(q,{noOfLines:1})}),e.jsx(j,{children:e.jsx(q,{noOfLines:1})}),e.jsx(j,{children:e.jsx(q,{noOfLines:1})})]},i))})]}),us=25;function Q({value:r,onChange:i,children:d,...l}){return e.jsx("select",{value:r,onChange:n=>i(n.target.value),style:{width:"100%",padding:"8px",borderRadius:"6px",borderWidth:"1px",borderStyle:"solid",backgroundColor:"var(--chakra-colors-input-bg)",borderColor:"var(--chakra-colors-input-border)",color:"var(--chakra-colors-text-primary)",fontSize:"14px",cursor:"pointer",...l.style},onFocus:n=>{n.currentTarget.style.borderColor="var(--chakra-colors-teal-500)",n.currentTarget.style.boxShadow="0 0 0 1px var(--chakra-colors-teal-500)"},onBlur:n=>{n.currentTarget.style.borderColor="var(--chakra-colors-input-border)",n.currentTarget.style.boxShadow="none"},...l,children:d})}function hs(r){const i=r.toLowerCase();return i.includes("active")?"green":i.includes("inactive")||i.includes("discontinued")||i.includes("out of stock")?"red":i.includes("coming soon")?"blue":"gray"}function gs(r,i){return r===0?"red":i&&r<=i?"orange":"green"}function xs({product:r,statuses:i,onStatusChange:d}){const[l,n]=b.useState(!1),[c,S]=b.useState(!1),k=i.find(t=>t.id===r.status_id),o=hs(k?.name||""),C=async t=>{if(t!==r.status_id){S(!0);try{await d(r.id,t),setTimeout(()=>{S(!1),n(!1)},500)}catch(x){console.error("Failed to update status:",x),S(!1),n(!1)}}else n(!1)},u=t=>{t.key==="Escape"&&n(!1)},P=()=>{setTimeout(()=>n(!1),150)};return l?e.jsx("select",{value:r.status_id,onChange:t=>C(t.target.value),onKeyDown:u,onBlur:P,autoFocus:!0,disabled:c,style:{fontSize:"14px",minWidth:"130px",opacity:c?.7:1,cursor:c?"wait":"pointer",backgroundColor:"var(--chakra-colors-input-bg)",borderColor:"var(--chakra-colors-input-border)",padding:"6px",borderRadius:"6px",borderWidth:"1px",borderStyle:"solid",color:"var(--chakra-colors-text-primary)"},children:i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))}):e.jsxs(f,{colorScheme:c?"blue":o,cursor:"pointer",onClick:()=>n(!0),_hover:{opacity:.8,transform:"scale(1.02)",boxShadow:"md"},transition:"all 0.2s ease",size:"sm",px:3,py:1,borderRadius:"md",title:"Click to change status",position:"relative",overflow:"hidden",children:[c&&e.jsx(g,{as:"span",position:"absolute",top:"0",left:"0",right:"0",bottom:"0",display:"flex",alignItems:"center",justifyContent:"center",bg:{base:"rgba(0,0,0,0.2)",_light:"rgba(255,255,255,0.8)"},fontSize:"xs",color:{base:"white",_light:"gray.800"},children:"⏳"}),k?.name||"Unknown"]})}function ms({page:r,pageSize:i,search:d,category:l,status:n}){const c={skip:(r-1)*i,limit:i};return d.trim()&&(c.name=d.trim()),l&&(c.categoryId=l),n&&(c.statusId=n),{queryKey:["products",{page:r,pageSize:i,search:d,category:l,status:n}],queryFn:()=>K.readProducts(c)}}function ps(){const r=Oe({from:"/products"}),{page:i,search:d,category:l,status:n,pageSize:c}=Le.useSearch(),S=oe(),{showSuccessToast:k}=ce(),[o,C]=b.useState(d),[u,P]=b.useState(d);b.useEffect(()=>{const s=setTimeout(()=>{P(o)},300);return()=>clearTimeout(s)},[o]),b.useEffect(()=>{u!==d&&r({to:"/products",search:s=>({...s,search:u,page:1})})},[u,d,r]),b.useEffect(()=>{r({to:"/products",search:s=>({...s,page:1})})},[l,n]);const[t,x]=b.useState({image:!0,name:!0,description:!1,category:!0,buyingPrice:!1,sellingPrice:!1,currentStock:!1,reorderLevel:!0,status:!0,actions:!0}),{data:I}=ie({queryKey:["categories"],queryFn:()=>K.readCategories()}),{data:Z}=ie({queryKey:["statuses"],queryFn:()=>K.readStatuses()}),z=Z||[],{data:N,isLoading:R,isPlaceholderData:ee}=ie({...ms({page:i,pageSize:c,search:u,category:l,status:n}),placeholderData:s=>s}),G=le({mutationFn:({productId:s,statusId:a})=>K.updateProduct({id:s,requestBody:{status_id:a}}),onSuccess:()=>{k("Status updated successfully! ✅"),S.invalidateQueries({queryKey:["products"]})},onError:s=>{console.error("Update status error:",s),s?.status===403||s?.body?.detail?.includes("permission")?W(s):s?.status===404?W(s):W(s)}}),y=async(s,a)=>G.mutateAsync({productId:s,statusId:a}),T=s=>{x(a=>({...a,[s]:!a[s]}))},U=s=>{r({to:"/products",search:a=>({...a,page:s})})},se=s=>{r({to:"/products",search:a=>({...a,pageSize:s,page:1})})},$=s=>{r({to:"/products",search:a=>({...a,category:s,page:1})})},V=s=>{r({to:"/products",search:a=>({...a,status:s,page:1})})},Y=()=>{C(""),r({to:"/products",search:()=>({page:1,search:"",category:"",status:"",pageSize:c||us})})},M=N?.data||[],D=N?.count||0,_=Math.ceil(D/c),h=o||l||n;return R?e.jsx(ds,{}):M.length===0?e.jsxs(A,{gap:6,align:"stretch",children:[e.jsx(m,{p:4,borderWidth:"1px",borderRadius:"lg",children:e.jsxs(A,{gap:4,align:"stretch",children:[e.jsxs(ne,{direction:{base:"column",md:"row"},gap:4,children:[e.jsx(m,{flex:1,children:e.jsx(v,{label:"Search Products",children:e.jsxs(m,{position:"relative",children:[e.jsx(E,{placeholder:"Search by product name only...",value:o,onChange:s=>C(s.target.value),size:"md",pr:o&&o!==u?"10":"4"}),o&&o!==u&&e.jsx(m,{position:"absolute",right:"2",top:"50%",transform:"translateY(-50%)",children:e.jsx(g,{fontSize:"xs",color:{base:"gray.500",_light:"gray.600"},children:"⏳"})})]})})}),e.jsx(m,{minW:{base:"full",md:"200px"},children:e.jsx(v,{label:"Category",children:e.jsxs(Q,{value:l,onChange:$,children:[e.jsx("option",{value:"",children:"All Categories"}),I?.data.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})}),e.jsx(m,{minW:{base:"full",md:"200px"},children:e.jsx(v,{label:"Status",children:e.jsxs(Q,{value:n,onChange:V,children:[e.jsx("option",{value:"",children:"All Statuses"}),z?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})})]}),e.jsxs(H,{justify:"space-between",align:"center",children:[e.jsxs(w,{gap:2,children:[e.jsxs(g,{fontSize:"sm",color:{base:"gray.500",_light:"gray.600"},children:["Showing ",M.length," of ",D," products",_>1&&` (Page ${i} of ${_})`]}),h&&e.jsxs(w,{gap:1,children:[u&&e.jsxs(f,{colorScheme:"teal",size:"sm",children:['Name: "',u,'"']}),l&&I?.data&&e.jsx(f,{colorScheme:"blue",size:"sm",children:I.data.find(s=>s.id===l)?.name}),n&&z&&e.jsx(f,{colorScheme:"purple",size:"sm",children:z.find(s=>s.id===n)?.name})]})]}),h&&e.jsxs(O,{size:"sm",variant:"ghost",onClick:Y,children:[e.jsx(he,{})," Clear Filters"]})]})]})}),e.jsx(rs,{children:e.jsxs(ts,{children:[e.jsx(is,{children:e.jsx(qe,{})}),e.jsxs(A,{textAlign:"center",children:[e.jsx(ns,{children:h?"No products match your filters":"You don't have any products yet"}),e.jsx(as,{children:h?"Try adjusting your search or filters":"Start by adding your first product to the inventory."})]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{p:4,borderWidth:"1px",borderRadius:"lg",mb:4,children:e.jsxs(A,{gap:4,align:"stretch",children:[e.jsxs(ne,{direction:{base:"column",md:"row"},gap:4,children:[e.jsx(m,{flex:1,children:e.jsx(v,{label:"Search Products",children:e.jsxs(m,{position:"relative",children:[e.jsx(E,{placeholder:"Search by product name only...",value:o,onChange:s=>C(s.target.value),size:"md",pr:o&&o!==u?"10":"4"}),o&&o!==u&&e.jsx(m,{position:"absolute",right:"2",top:"50%",transform:"translateY(-50%)",children:e.jsx(g,{fontSize:"xs",color:{base:"gray.500",_light:"gray.600"},children:"⏳"})})]})})}),e.jsx(m,{minW:{base:"full",md:"200px"},children:e.jsx(v,{label:"Category",children:e.jsxs(Q,{value:l,onChange:$,children:[e.jsx("option",{value:"",children:"All Categories"}),I?.data.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})}),e.jsx(m,{minW:{base:"full",md:"200px"},children:e.jsx(v,{label:"Status",children:e.jsxs(Q,{value:n,onChange:V,children:[e.jsx("option",{value:"",children:"All Statuses"}),z?.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})})]}),e.jsxs(H,{justify:"space-between",align:"center",children:[e.jsxs(w,{gap:2,children:[e.jsxs(g,{fontSize:"sm",color:{base:"gray.500",_light:"gray.600"},children:["Showing ",M.length," of ",D," products",_>1&&` (Page ${i} of ${_})`]}),h&&e.jsxs(w,{gap:1,children:[u&&e.jsxs(f,{colorScheme:"teal",size:"sm",children:['Name: "',u,'"']}),l&&I?.data&&e.jsx(f,{colorScheme:"blue",size:"sm",children:I.data.find(s=>s.id===l)?.name}),n&&z&&e.jsx(f,{colorScheme:"purple",size:"sm",children:z.find(s=>s.id===n)?.name})]})]}),h&&e.jsxs(O,{size:"sm",variant:"ghost",onClick:Y,children:[e.jsx(he,{})," Clear Filters"]})]})]})}),e.jsx(H,{justify:"flex-end",mb:4,children:e.jsxs(ge,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(O,{variant:"outline",size:"sm",children:[e.jsx(B,{})," Columns"]})}),e.jsxs(me,{children:[e.jsxs(F,{value:"image",onClick:()=>T("image"),children:[t.image?e.jsx(B,{}):e.jsx(L,{}),"Image"]}),e.jsxs(F,{value:"category",onClick:()=>T("category"),children:[t.category?e.jsx(B,{}):e.jsx(L,{}),"Category"]}),e.jsxs(F,{value:"buyingPrice",onClick:()=>T("buyingPrice"),children:[t.buyingPrice?e.jsx(B,{}):e.jsx(L,{}),"Buying Price"]}),e.jsxs(F,{value:"sellingPrice",onClick:()=>T("sellingPrice"),children:[t.sellingPrice?e.jsx(B,{}):e.jsx(L,{}),"Selling Price"]}),e.jsxs(F,{value:"currentStock",onClick:()=>T("currentStock"),children:[t.currentStock?e.jsx(B,{}):e.jsx(L,{}),"Current Stock"]}),e.jsxs(F,{value:"reorderLevel",onClick:()=>T("reorderLevel"),children:[t.reorderLevel?e.jsx(B,{}):e.jsx(L,{}),"Reorder Level"]}),e.jsxs(F,{value:"status",onClick:()=>T("status"),children:[t.status?e.jsx(B,{}):e.jsx(L,{}),"Status"]})]})]})}),e.jsxs(pe,{size:{base:"sm",md:"md"},variant:"outline",children:[e.jsx(je,{children:e.jsxs(J,{children:[t.image&&e.jsx(p,{children:"Image"}),e.jsx(p,{children:"Product"}),t.category&&e.jsx(p,{children:"Category"}),t.buyingPrice&&e.jsx(p,{children:"Buying Price"}),t.sellingPrice&&e.jsx(p,{children:"Selling Price"}),t.currentStock&&e.jsx(p,{children:"Current Stock"}),t.reorderLevel&&e.jsx(p,{children:"Reorder Level"}),t.status&&e.jsx(p,{children:"Status"}),t.actions&&e.jsx(p,{children:"Actions"})]})}),e.jsx(be,{children:M.map(s=>e.jsxs(J,{opacity:ee?.5:1,children:[t.image&&e.jsx(j,{children:s.image?.file_name?e.jsx(ae,{src:`/uploads/products/${s.image.file_name}`,alt:s.name,boxSize:"40px",objectFit:"cover",borderRadius:"md"}):e.jsx(g,{fontSize:"xs",color:{base:"gray.500",_light:"gray.400"},children:"No image"})}),e.jsx(j,{fontWeight:"medium",children:s.name}),t.description&&e.jsx(j,{children:s.description||"-"}),t.category&&e.jsx(j,{children:e.jsx(f,{colorScheme:"purple",size:"sm",children:s.category?.name||"-"})}),t.buyingPrice&&e.jsxs(j,{children:["KES ",parseFloat(s.buying_price).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),t.sellingPrice&&e.jsxs(j,{fontWeight:"semibold",children:["KES ",parseFloat(s.selling_price).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),t.currentStock&&e.jsx(j,{children:e.jsxs(f,{colorScheme:gs(s.current_stock??0,s.reorder_level??void 0),size:"sm",children:[s.current_stock??0," units"]})}),t.reorderLevel&&e.jsx(j,{children:s.reorder_level||"-"}),t.status&&e.jsx(j,{children:e.jsx(xs,{product:s,statuses:z,onStatusChange:y})}),t.actions&&e.jsx(j,{children:e.jsx(cs,{product:s})})]},s.id))})]}),e.jsx(m,{p:4,borderWidth:"1px",borderRadius:"lg",mt:4,children:e.jsxs(ne,{direction:{base:"column",md:"row"},justify:"space-between",align:"center",gap:4,children:[e.jsxs(w,{gap:2,children:[e.jsx(g,{fontSize:"sm",color:{base:"gray.500",_light:"gray.600"},children:"Items per page:"}),e.jsxs(Q,{value:c,onChange:s=>se(Number(s)),style:{maxWidth:"80px",fontSize:"14px",padding:"4px"},children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsxs(g,{fontSize:"sm",color:{base:"gray.500",_light:"gray.600"},children:["(",(i-1)*c+1,"-",Math.min(i*c,D)," of ",D,")"]})]}),_>1&&e.jsxs(We,{count:D,pageSize:c,page:i,onPageChange:s=>U(s.page),children:[e.jsx(Ne,{}),e.jsx(Me,{}),e.jsx(Ke,{})]}),_>10&&e.jsxs(w,{gap:2,children:[e.jsx(g,{fontSize:"sm",color:"gray.500",children:"Go to page:"}),e.jsx(E,{type:"number",min:"1",max:_,value:i,onChange:s=>{const a=Number(s.target.value);a>=1&&a<=_&&U(a)},w:"20",size:"sm"})]})]})})]})}function ks(){return e.jsx(Be,{maxW:"full",minH:"100vh",children:e.jsxs(H,{direction:"column",gap:6,pt:12,pb:8,children:[e.jsx(H,{justify:"space-between",align:"center",children:e.jsx(es,{size:"lg",children:"Products Catalog"})}),e.jsx(ps,{})]})})}export{ks as component};
